### Teaching Threat Hunting for Uber Breach-Like Attacks (2016): A Pro Threat Hunter's Step-by-Step Guide

As a professional threat hunter specializing in supply-chain and cloud compromise incidents, I'll guide you through proactive threat hunting to detect attacks resembling the 2016 Uber data breach. This incident involved two Eastern European cybercriminals, Brandon Charles Glover (U.S.-based) and Vasile Mereacre (Moldovan), who discovered an AWS access key accidentally committed to Uber's public GitHub repository. Using the key, they accessed an unencrypted S3 bucket containing sensitive data on 57 million users (50M riders: names, emails, phone numbers, locations; 7M drivers: license numbers, SSNs). Uber's then-CISO Joe Sullivan paid the hackers $100,000 (framed as a bug bounty) to delete the data and stay silent, concealing the breach until November 2017 amid the FTC's investigation into Uber's 2014 breach. The actors were indicted in 2018 (Glover pleaded guilty, Mereacre extradited); they used similar tactics against Lynda.com (LinkedIn). No advanced malware; it was opportunistic credential exposure.

Dwell time: ~14 months (October 2016 access to November 2017 disclosure), undetected due to no GitHub monitoring, unencrypted cloud storage, and cover-up. Detection: FTC pressure during 2014 breach probe revealed the incident. Impacts: $148M FTC settlement (2018, including $24M redress), $1.1M state AG settlement, criminal charges against Sullivan (acquitted 2023), reputational harm, and FTC consent order mandating code audits. From a MITRE ATT&CK Enterprise perspective, key tactics include TA0001 (Initial Access: Supply Chain Compromise T1195), TA0005 (Defense Evasion: Impair Defenses T1562.001 via cover-up), TA0007 (Discovery: Cloud Service Discovery T1526), TA0006 (Credential Access: Unsecured Credentials T1552.005), TA0009 (Collection: Data from Cloud Storage T1530), and TA0010 (Exfiltration: Exfiltration Over Web Service T1567.002).

Threat hunting assumes exposure: Hypothesis-driven searches for code repo leaks leading to cloud data theft in tech firms. Realistic parameters:
- **Environment**: Cloud-heavy (e.g., AWS S3, GitHub for code); devops pipelines without secrets scanning.
- **Adversary Profile**: Cybercriminals (opportunistic repo scans, extortion; low noise, bug bounty framing).
- **Challenges**: Public repos expose keys silently, unencrypted buckets, cover-up risks (e.g., non-disclosure).
- **Tools/Data Sources**: CloudTrail (AWS logs), GitHub API/audits, SIEM (Splunk for access anomalies), secrets scanners (TruffleHog), YARA/Sigma for IOCs (e.g., AWS keys patterns).
- **Hypotheses**: E.g., "An adversary has exploited leaked cloud creds to access sensitive buckets."

This guide covers **each relevant MITRE ATT&CK technique** (inferred from FTC report, DOJ indictments, and Uber disclosures). Proceed tactic-by-tactic with sub-steps: hypothesis, data collection, analysis, pivoting. Includes realistic queries, Sigma rules, and expert tips. Hunt in scoped envs (e.g., dev sandboxes) to avoid prod exposure. Baselines: 30-60 days of cloud/repo logs for anomalies.

#### Step 1: Preparation - Intelligence Gathering and Environment Mapping
Contextualize the breachâ€”Uber's public GitHub commit enabled AWS access; prioritize secrets scanning.
- **Gather Threat Intel**: Review MITRE ATT&CK for supply-chain (e.g., T1195 for repo leaks). IOCs: AWS key patterns (e.g., AKIA[0-9A-Z]{16}), hacker handles (e.g., Glover/Mereacre on forums), S3 bucket names (e.g., uber-user-data). Cross-ref FTC settlement, DOJ indictment, Breaches.cloud, and TechTarget timeline.
- **Map Your Environment**: Inventory repos (GitHub), cloud storage (S3 buckets), access policies (IAM roles). Use GitHub Advanced Security or TruffleHog for secrets; AWS Config for bucket encryption.
- **Baseline Normal Behavior**: Log repo commits (no keys), S3 accesses (internal IPs only), outbound (no extortion contacts). Tool: Sysmon (cloud-integrated for API calls); CloudTrail for access events.
- **Expert Tip**: Automate repo scans (e.g., GitHub Actions). Hypothesis: "Hackers scan public repos for cloud keys; hunt leaked secrets leading to anomalous storage access."

#### Step 2: Hunt for Initial Access (TA0001) - Supply Chain Compromise (T1195)
Discovered AWS key in public GitHub repo.
- **Hypothesis**: "An adversary has exploited leaked credentials from code repositories."
- **Data Sources**: GitHub audit logs (commits with secrets), web scans (public repo crawls).
- **Step-by-Step Hunting**:
  1. Query Leaks: Splunk SPL (or GitHub CLI): `index=repo commit_message="*aws*" | search file_path="*.py OR *.js" content_regex="AKIA[0-9A-Z]{16}" | stats count by repo, author`.
  2. Sigma Rule (YAML):
     ```
     title: Leaked Cloud Credential in Repo
     logsource:
       category: git
     detection:
       selection:
         commit: '*aws_access_key*'
         file: '*.env OR *.config'
         visibility: 'public'
       condition: selection
     ```
     Deploy in GitHub SIEM; alert on key patterns.
  3. Analyze: Use TruffleHog to scan repos: `trufflehog git https://github.com/org/repo --regex`; check for historical commits.
  4. Pivoting: If hits, query CloudTrail for accesses from unknown IPs post-commit.
- **Expert Tip**: Pre-commit hooks for secrets. Realistic: Accidental push; hunt historical repos.

#### Step 3: Hunt for Execution (TA0002) - User Execution (T1204.002): Valid Accounts
Used leaked key to execute AWS API calls (e.g., list buckets).
- **Hypothesis**: "Stolen creds enable cloud resource access."
- **Data Sources**: CloudTrail (API invocations), Sysmon ID 1 (awscli.exe if local).
- **Step-by-Step**:
  1. Query API Calls: Splunk: `index=cloudtrail eventName="ListBuckets" userIdentity.accessKeyId="AKIA*" | stats count by src_ip | where src_ip!="internal"`.
  2. Sigma Rule:
     ```
     title: Anomalous Cloud API Execution
     logsource:
       category: cloud_api
     detection:
       selection:
         eventName: 'ListBuckets OR GetObject'
         accessKey: 'AKIA*'
         src_ip: external
       condition: selection
     ```
  3. Forensics: AWS Console logs for unusual user agents (e.g., curl from hackers).
  4. Pivoting: Correlate with data reads.
- **Expert Tip**: IAM logging. Realistic: Direct API; hunt unknown keys.

#### Step 4: Hunt for Persistence (TA0003) - Valid Accounts (T1078)
No long-term persistence; opportunistic use of key.
- **Hypothesis**: "Adversary reuses leaked creds without implants."
- **Data Sources**: CloudTrail (repeated API from same key).
- **Step-by-Step**:
  1. Query Reuse: Splunk: `index=cloudtrail accessKeyId="suspect_key" | stats count by src_ip, _time | where count > baseline`.
  2. Sigma Rule:
     ```
     title: Persistent Cloud Access
     logsource:
       category: cloud_api
     detection:
       selection:
         accessKey: 'leaked_key'
         eventName: 'AssumeRole OR List*'
       condition: selection
     ```
  3. Scan: Revoke/rotate keys; hunt for key propagation (e.g., in scripts).
  4. Pivoting: To discovery.
- **Expert Tip**: Key rotation policies. Realistic: Short use; hunt spikes.

#### Step 5: Hunt for Privilege Escalation (TA0004) - Valid Accounts (T1078)
Key had over-priv'd IAM role for S3 access.
- **Hypothesis**: "Leaked creds escalated via broad IAM policies."
- **Data Sources**: CloudTrail (role assumptions), IAM policies.
- **Step-by-Step**:
  1. Query Assumptions: Splunk: `index=cloudtrail eventName="AssumeRole" roleName="data_access" | table _time, principalId`.
  2. Sigma Rule:
     ```
     title: IAM Escalation
     logsource:
       category: cloud_api
     detection:
       selection:
         eventName: 'AssumeRole'
         role: 'over_priv*'
         principal: 'external_key'
       condition: selection
     ```
  3. Audit: IAM Access Analyzer for excessive S3 perms.
  4. Pivoting: To collection.
- **Expert Tip**: Least-priv IAM. Realistic: Broad key; hunt role use.

#### Step 6: Hunt for Defense Evasion (TA0005) - Impair Defenses (T1562.001 via Cover-Up)
Paid ransom to conceal; no technical evasion but non-disclosure.
- **Hypothesis**: "Incident concealed post-access."
- **Data Sources**: Internal comms logs, unusual payments (e.g., BTC).
- **Step-by-Step**:
  1. Query Cover-Up: Splunk: `index=internal_email keyword="bug bounty" OR "hacker payment" | stats count by user="sullivan"`.
  2. Sigma Rule:
     ```
     title: Breach Concealment Indicators
     logsource:
       category: email_activity
     detection:
       selection:
         subject: '*ransom OR *delete data*'
         recipient: 'external_hacker'
       condition: selection
     ```
  3. Financial: Hunt anomalous transfers (e.g., $100K BTC).
  4. Pivoting: To external contacts.
- **Expert Tip**: Incident reporting mandates. Realistic: Hush money; hunt off-books.

#### Step 7: Hunt for Credential Access (TA0006) - Unsecured Credentials (T1552.005: Cloud Instance Metadata Service, but Repo)
Accessed via leaked AWS key (unsecured in repo).
- **Hypothesis**: "Secrets exposed in code lead to cloud creds."
- **Data Sources**: Repo scans, CloudTrail (key use).
- **Step-by-Step**:
  1. Query Exposure: Splunk: `index=repo content="AWS_ACCESS_KEY_ID" | stats count by file`.
  2. Sigma Rule:
     ```
     title: Cloud Secret Exposure
     logsource:
       category: git
     detection:
       selection:
         content: 'AKIA[0-9A-Z]{16}'
         visibility: 'public'
       condition: selection
     ```
  3. Validate: Test keys (non-prod); hunt rotations.
  4. Pivoting: To API calls.
- **Expert Tip**: Secrets management (e.g., AWS SSM). Realistic: GitHub push; hunt patterns.

#### Step 8: Hunt for Discovery (TA0007) - Cloud Service Discovery (T1526)
Listed S3 buckets/objects with key.
- **Hypothesis**: "Leaked creds used to enumerate cloud resources."
- **Data Sources**: CloudTrail (ListBuckets/GetBucketLocation).
- **Step-by-Step**:
  1. Query Discovery: Splunk: `index=cloudtrail eventName="ListBuckets" accessKey="suspect" | stats dc(bucket) by _time`.
  2. Sigma Rule:
     ```
     title: Cloud Enumeration
     logsource:
       category: cloud_api
     detection:
       selection:
         eventName: 'ListBuckets OR ListObjects'
         accessKey: external
       condition: selection
     ```
  3. Analyze: Bucket policies for public exposure.
  4. Pivoting: To collection.
- **Expert Tip**: Bucket logging. Realistic: Found user-data; hunt lists.

#### Step 9: Hunt for Collection (TA0009) - Data from Cloud Storage Object (T1530)
Downloaded 57M user records from S3.
- **Hypothesis**: "Sensitive data collected from exposed storage."
- **Data Sources**: CloudTrail (GetObject), S3 access logs.
- **Step-by-Step**:
  1. Query Downloads: Splunk: `index=cloudtrail eventName="GetObject" bucket="user-data" bytes > 1GB | stats sum(bytes) by src_ip`.
  2. Sigma Rule:
     ```
     title: Cloud Data Theft
     logsource:
       category: cloud_api
     detection:
       selection:
         eventName: 'GetObject'
         bucket: 'sensitive*'
         bytesDownloaded: '>100MB'
       condition: selection
     ```
  3. Forensics: S3 inventory for unusual objects.
  4. Pivoting: To exfil (though direct download).
- **Expert Tip**: Encryption at rest. Realistic: Unencrypted PII; hunt large gets.

#### Step 10: Hunt for Command and Control (TA0011) - Minimal (Direct API)
No C2; direct AWS API from hacker machines.
- **Hypothesis**: "Access via direct cloud APIs without beacons."
- **Data Sources**: CloudTrail (external IPs).
- **Step-by-Step**:
  1. Query Direct: Splunk: `index=cloudtrail src_ip="external" eventName="*" | stats dc(event) by src_ip`.
  2. Sigma Rule:
     ```
     title: Direct Cloud Access
     logsource:
       category: cloud_api
     detection:
       selection:
         src_ip: external
         eventName: 'GetObject OR List*'
       condition: selection
     ```
  3. Geoloc: Eastern Europe IPs.
  4. Pivoting: To extortion.
- **Expert Tip**: Geo-fencing IAM. Realistic: No malware; hunt IPs.

#### Step 11: Hunt for Exfiltration (TA0010) - Exfiltration Over Web Service (T1567.002)
Downloaded data directly; no further exfil (deleted post-ransom).
- **Hypothesis**: "Cloud data exfiltrated via API downloads."
- **Data Sources**: CloudTrail (GetObject volumes), network egress.
- **Step-by-Step**:
  1. Query Exfil: Splunk: `index=cloudtrail eventName="GetObject" bytes_out > 500MB | stats sum(bytes) by accessKey`.
  2. Sigma Rule:
     ```
     title: Bulk Cloud Exfil
     logsource:
       category: cloud_api
     detection:
       selection:
         eventName: 'GetObject'
         bytes: '>1GB'
       condition: selection
     ```
  3. PCAP: If proxied, hunt large transfers.
  4. Pivoting: To dark web dumps.
- **Expert Tip**: S3 transfer acceleration limits. Realistic: Direct; hunt volumes.

#### Step 12: Hunt for Impact (TA0040) - Account Access Removal (T1531 via Extortion)
Extorted for silence; no destruction but cover-up impacted compliance.
- **Hypothesis**: "Breach leads to extortion or non-disclosure."
- **Data Sources**: Financial logs (BTC payments), internal emails.
- **Step-by-Step**:
  1. Query Extortion: Splunk: `index=financial transaction="100k BTC" | search keyword="hacker"`.
  2. Sigma Rule:
     ```
     title: Extortion Indicators
     logsource:
       category: email_activity
     detection:
       selection:
         subject: '*bug bounty ransom*'
         recipient: external
       condition: selection
     ```
  3. Monitor: Dark web for Uber dumps.
  4. Pivoting: FTC probes.
- **Expert Tip**: Report mandates. Realistic: Hush money; hunt off-books.

#### Step 13: Post-Hunt - Response, Remediation, and Iteration
- **If Found**: Contain (revoke keys, isolate buckets), eradicate (scan repos, rotate creds), recover (encrypt data, notify FTC). Like Uber, settle with regulators; avoid payments.
- **Lessons**: Per FTC, scan repos, encrypt S3, disclose breaches. Iterate weekly; simulate with leaked key tests.
- **Expert Tip**: ATT&CK Navigator for cloud; evolve for 2025 (e.g., AI secrets detection).
